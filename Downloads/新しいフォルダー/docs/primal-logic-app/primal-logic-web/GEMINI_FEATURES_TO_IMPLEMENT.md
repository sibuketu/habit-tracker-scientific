# Gemini風機能の実装リスト（一気に実装）

## 🎯 実装すべき機能（Gemini UIから）

### 1. 入力エリアの機能拡張（最優先）

#### 1.1 "+"ボタン（ファイルアップロード）
- **機能**: 画像、ファイルをアップロード
- **実装内容**:
  - 写真から追加（既存の`handlePhoto`機能を統合）
  - アルバムから選択（新規実装）
  - ファイルアップロード（血液検査結果CSV、テキストファイルなど）
  - バーコード読み取り（既存機能を統合）
- **UI**: 入力フィールドの左側に"+"ボタンを配置

#### 1.2 "ツール"ボタン（高度な機能）
- **機能**: Deep Research、ガイド付き学習など
- **実装内容**:
  - **Deep Research**: カーニボア関連の深いリサーチ（Gemini APIを使用）
  - **ガイド付き学習**: カーニボア移行ガイド、栄養素学習
  - **症状推論**: ユーザーのログから原因を推論（「腹痛がする」→ 直近のログから原因を推論）
  - **誠実さスコア確認**: 記録の信頼性を確認
- **UI**: 入力フィールドの右側に"ツール"ボタンを配置

#### 1.3 思考モード選択（既に実装済み、UI追加のみ）
- **機能**: 高速モード、思考モード、Pro
- **実装内容**:
  - ドロップダウンメニューで選択可能に
  - 現在の`aiMode`をUIで変更可能に
- **UI**: 入力フィールドの右側にドロップダウンを配置

### 2. Geminiとの会話から考えられる機能

#### 2.1 AI対話メインのUI構築- **機能**: ユーザーが「腹痛がする」と言えば、AIが直近のログから原因を推論
- **実装内容**:
  - ユーザーの日次ログ（睡眠、日光、脂質、誠実さスコア）をAIに送信
  - AIが原因を推論して回答
  - 推論の根拠を表示（どのログから判断したか）

#### 2.2 3つのログモード- **機能**: アプリ外情報源を含むAIモード、実践者ログ＋AIモード、ログ単体モード
- **実装内容**:
  - モード選択UIを追加
  - 各モードでAIの回答内容を変更
  - アプリ外情報源（天気API、ヘルスケアアプリ）との連携

#### 2.3 誠実さスコアの表示- **機能**: 記録の信頼性を%で表示
- **実装内容**:
  - 写真撮影: 70%
  - AI深掘り質問: 90%
  - 外部連携（天気、運動）: 自動取得
  - 手動入力: ペナルティ
  - 「していないこと」の記録: チェックリスト化

#### 2.4 栄養素貯蔵タンクの表示- **機能**: ビタミンA等の脂溶性栄養素の蓄積量を1週間単位で可視化
- **実装内容**:
  - 既存の`StorageNutrientGauge`を拡張
  - 1週間単位での可視化
  - 安全マージンの表示

#### 2.5 移行ガイドの動的アルゴリズム- **機能**: 専門家知見をベースにした動的アドバイス
- **実装内容**:
  - If-Thenプランニング（「外食で肉がない時」「糖質を欲した時」の行動を自動提示）
  - 断食の活用（適応を加速させるためのオプション）
  - 症状の自動検出とアドバイス

### 3. UI/UXの改善

#### 3.1 入力フィールドの拡張
- **大きな入力フィールド**: Gemini風の大きな入力エリア
- **プレースホルダー**: 「CarnivOS に相談」または「カーニボス に相談」
- **モバイル対応**: レスポンシブデザイン

#### 3.2 クイックアクションボタン（将来的に実装）
- 画像の作成
- 動画の作成
- 何でも書く
- 知識習得サポート
- 一日を盛り上げる

## 🚀 実装優先順位

### 最優先（今すぐ実装）
1. **全画面表示時のボタン表示修正**: 💬ボタンを非表示
2. **"+"ボタンの実装**: 写真、アルバム、ファイルアップロード
3. **"ツール"ボタンの実装**: Deep Research、ガイド付き学習、症状推論
4. **思考モード選択UI**: ドロップダウンメニューで選択可能に

### 高優先度（次に実装）
5. **AI対話メインのUI構築**: ユーザーのログから原因を推論
6. **3つのログモード**: アプリ外情報源を含むAIモードなど
7. **誠実さスコアの表示**: 記録の信頼性を%で表示

### 中優先度（将来的に実装）
8. **栄養素貯蔵タンクの拡張**: 1週間単位での可視化
9. **移行ガイドの動的アルゴリズム**: If-Thenプランニング、症状の自動検出

### 低優先度（将来的に実装）
10. **クイックアクションボタン**: 画像の作成、動画の作成など

## 📝 実装の具体的方法

### 1. "+"ボタンの実装
```typescript
// 入力フィールドの左側に"+"ボタンを配置
// クリックでドロップダウンメニューを表示:
// - 写真から追加（既存のhandlePhoto）
// - アルバムから選択（新規実装）
// - ファイルアップロード（血液検査結果CSV、テキストファイル）
// - バーコード読み取り（既存機能）
```

### 2. "ツール"ボタンの実装
```typescript
// 入力フィールドの右側に"ツール"ボタンを配置
// クリックでドロップダウンメニューを表示:
// - Deep Research（カーニボア関連の深いリサーチ）
// - ガイド付き学習（カーニボア移行ガイド、栄養素学習）
// - 症状推論（ユーザーのログから原因を推論）
// - 誠実さスコア確認（記録の信頼性を確認）
```

### 3. 思考モード選択UIの実装
```typescript
// 入力フィールドの右側にドロップダウンを配置
// 選択可能なモード:
// - 高速モード（Gemini Flash）
// - 思考モード（Gemini Pro）
// - Pro（Gemini Pro 2.0）
// 現在のaiModeをUIで変更可能に
```

### 4. AI対話メインのUI構築
```typescript
// ユーザーが「腹痛がする」と言えば:
// 1. 直近のログ（睡眠、日光、脂質、誠実さスコア）を取得
// 2. AIに送信して原因を推論
// 3. 推論の根拠を表示（どのログから判断したか）
```

## 🎨 UIの配置

```
[AIチャット ヘッダー]
┌─────────────────────────────────────────┐
│ [+ボタン] [大きな入力フィールド] [ツール] [思考モード▼] [🎤] [送信] │
└─────────────────────────────────────────┘
```

- **+ボタン**: 左端、ファイルアップロード用
- **入力フィールド**: 中央、flex: 1で拡張
- **ツールボタン**: 右側、高度な機能用
- **思考モード**: 右側、ドロップダウン
- **🎤ボタン**: 右側、音声入力（既存）
- **送信ボタン**: 右端、送信用

