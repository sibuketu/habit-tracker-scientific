# iPhone実機テスト - トラブルシューティングガイド

## 🔍 アクセスできない場合の確認手順

### ステップ1: PCのブラウザで動作確認

まず、PCのブラウザ（Chrome/Edge）で以下にアクセスして、開発サーバーが起動しているか確認してください：

```
http://localhost:5174
```

**結果**:
- ✅ **表示される場合**: 開発サーバーは正常に起動しています。次のステップに進んでください。
- ❌ **表示されない場合**: 開発サーバーが起動していないか、エラーが発生しています。
  - ターミナルでエラーメッセージを確認
  - `npm run dev`を再実行

### ステップ2: IPアドレスの確認

PowerShellまたはコマンドプロンプトで以下を実行して、PCのIPアドレスを確認してください：

```powershell
ipconfig
```

「IPv4 アドレス」を探してください。例：
```
IPv4 アドレス . . . . . . . . . : 172.20.10.2
```

**注意**: IPアドレスは変わる可能性があります。アクセスできない場合は、再度確認してください。

### ステップ3: Windowsファイアウォールの確認

Windowsファイアウォールでポート5174がブロックされている可能性があります。

#### 方法1: ファイアウォールでポートを開く（推奨）

1. Windowsの検索で「Windows Defender ファイアウォール」を検索
2. 「詳細設定」をクリック
3. 「受信の規則」→「新しい規則」
4. 「ポート」を選択 → 「次へ」
5. 「TCP」を選択 → 「特定のローカル ポート」に `5174` を入力 → 「次へ」
6. 「接続を許可する」を選択 → 「次へ」
7. すべてのプロファイルにチェック → 「次へ」
8. 名前を「Vite Dev Server (5174)」などに設定 → 「完了」

#### 方法2: 開発サーバー起動時にファイアウォールを一時的に無効化（非推奨）

セキュリティ上の理由から、本番環境では推奨しません。

### ステップ4: ネットワークの確認

1. **PCとiPhoneが同じWi-Fiネットワークに接続されているか確認**
   - PCのWi-Fi名とiPhoneのWi-Fi名が同じか確認
   - 5GHzと2.4GHzの違いに注意（同じSSIDでも別ネットワークの場合あり）

2. **PCのネットワークプロファイルを確認**
   - 設定 → ネットワークとインターネット → Wi-Fi → プロパティ
   - 「ネットワーク プロファイル」が「プライベート」になっているか確認
   - 「パブリック」の場合は「プライベート」に変更

### ステップ5: 開発サーバーの起動確認

開発サーバーが起動すると、以下のようなメッセージが表示されます：

```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5174/
  ➜  Network: http://172.20.10.2:5174/
```

**「Network」のURL**が表示されていれば、ネットワークアクセスが有効です。

### ステップ6: iPhoneからアクセス

iPhoneのSafariで以下のURLを開いてください：

```
http://[PCのIPアドレス]:5174
```

例: `http://172.20.10.2:5174`

---

## 🚨 それでもアクセスできない場合

### 代替方法1: USB経由でテスト（Chrome DevTools）

1. iPhoneをUSBでPCに接続
2. iPhoneで「信頼する」を選択
3. PCでChromeを開く
4. `chrome://inspect`にアクセス
5. 「Discover network targets」にチェック
6. iPhoneのSafariでページを開く
7. Chrome DevToolsで確認

### 代替方法2: ngrokを使用（外部サービス）

ngrokなどのトンネリングサービスを使用して、外部からアクセスできるURLを生成する方法があります。

1. ngrokをインストール: `npm install -g ngrok`
2. 開発サーバーを起動: `npm run dev`
3. 別のターミナルで: `ngrok http 5174`
4. 表示されたURL（例: `https://xxxxx.ngrok.io`）をiPhoneで開く

**注意**: 無料プランではURLが毎回変わるため、テストのたびに新しいURLを取得する必要があります。

---

## 📱 アクセスできた場合の確認事項

1. ✅ ページが表示されるか
2. ✅ エラーが表示されないか
3. ✅ コンソールにエラーがないか（iPhone Safariのリモートデバッグを使用）

---

## 💡 よくある問題

### 問題1: 「接続がタイムアウトしました」

**原因**: ファイアウォールでブロックされているか、ネットワーク設定の問題

**解決策**:
- ステップ3のファイアウォール設定を確認
- ステップ4のネットワーク設定を確認

### 問題2: 「このサイトにアクセスできません」

**原因**: IPアドレスが間違っているか、開発サーバーが起動していない

**解決策**:
- ステップ2でIPアドレスを再確認
- ステップ1で開発サーバーが起動しているか確認

### 問題3: ページは表示されるが、機能が動作しない

**原因**: JavaScriptエラーや環境変数の問題

**解決策**:
- iPhone Safariのリモートデバッグでコンソールエラーを確認
- `.env`ファイルの環境変数が正しく設定されているか確認

---

最終更新: 2025-01-27

