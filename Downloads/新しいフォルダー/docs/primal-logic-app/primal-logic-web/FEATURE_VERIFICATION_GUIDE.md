# 機能確認手順書

## 1. 食品入力画面の機能確認

### 1.1 食品候補表示機能

**確認手順：**
1. アプリを起動し、「入力」画面に移動
2. 「食品:」の入力フィールドに「豚」と入力（2文字以上）
3. **確認ポイント：**
   - 「豚バラ」「豚ロース」「豚肩ロース」「豚スペアリブ」「豚ひき肉」などの候補が表示される
   - 各候補の右側に「animal」などのタイプが表示される
   - 候補をクリックすると、食品名が入力フィールドに自動入力される

**期待される動作：**
- 2文字以上入力すると候補が表示される
- 日本語名（「豚バラ」など）でも検索できる
- 候補を選択すると、推奨単位が自動設定される（例：卵の場合は「個」）

---

### 1.2 選択した食品の栄養情報表示

**確認手順：**
1. 食品候補から任意の食品を選択（例：「豚バラ」）
2. **確認ポイント：**
   - 「選択中の食品: 豚バラ」という情報ボックスが表示される
   - タンパク質、脂質、ビタミンB12、鉄分、亜鉛などの主要栄養素が表示される
   - 単位は「g/100g」または「μg/100g」「mg/100g」で表示される

**期待される動作：**
- 食品を選択すると、その食品の栄養情報が即座に表示される
- 栄養素が存在しない場合は表示されない（undefinedの場合は非表示）

---

### 1.3 栄養解説ボタン

**確認手順：**
1. 食品候補から任意の食品を選択（例：「豚バラ」）
2. 「栄養解説」ボタン（青色）をクリック
3. **確認ポイント：**
   - Argument Cardモーダルが表示される
   - 主要な栄養素（タンパク質、脂質、ビタミンC、鉄分、亜鉛）の解説が表示される
   - Level 1（Glance）、Level 2（Explanation）、Level 3（Source）の3段階で情報が表示される
   - 「×」ボタンまたは背景をクリックで閉じられる

**期待される動作：**
- 食品を選択していない場合は「栄養解説」ボタンが表示されない
- ボタンをクリックすると、該当する栄養素のArgument Cardが表示される
- 複数の栄養素がある場合は、最初に見つかった栄養素のCardが表示される

---

### 1.4 プレビュー機能

**確認手順：**
1. 食品候補から任意の食品を選択（例：「豚バラ」）
2. 量を入力（例：「50」g）
3. 「プレビュー」ボタン（緑色）をクリック
4. **確認ポイント：**
   - モーダルが表示され、「プレビュー: 豚バラ (50g追加した場合)」というタイトルが表示される
   - 左側に「現在の値」、右側に「追加後の値」が表示される
   - 追加後の値には、増加量が緑色で表示される（例：「+25.0g」）
   - 表示される栄養素：タンパク質（有効）、脂質、ビタミンB12、鉄分（有効）、亜鉛（有効）
   - 「×」ボタンまたは背景をクリックで閉じられる

**期待される動作：**
- 食品を選択していない場合は「プレビュー」ボタンが表示されない
- 量を変更すると、プレビューの計算結果も変わる
- 単位（g/個）を変更すると、計算結果が正しく反映される
- 既に食品が追加されている場合、それらを含めた合計値が表示される

---

### 1.5 食品追加機能

**確認手順：**
1. 食品を選択し、量を入力
2. 「食べ物を追加」ボタンをクリック
3. **確認ポイント：**
   - アラートが表示されない（以前は表示されていた）
   - 入力フィールドがクリアされる
   - 「追加した食品:」セクションに追加された食品が表示される
   - ホーム画面に移動すると、栄養素ゲージが更新されている

**期待される動作：**
- 食品を追加すると、即座に栄養素が計算される
- 複数の食品を追加すると、累積で計算される
- 個数入力（例：卵3個）の場合、正しい重量で計算される

---

## 2. ホーム画面の機能確認

### 2.1 全栄養素表示機能

**確認手順：**
1. ホーム画面に移動
2. 「全栄養素を見る」ボタン（青色）をクリック
3. **確認ポイント：**
   - モーダルが表示され、「全栄養素レポート」というタイトルが表示される
   - カテゴリ別に栄養素が表示される：
     - 主要マクロ（タンパク質、脂質、正味炭水化物）
     - カーニボア重要項目（ビタミンB12、亜鉛、鉄分、ビタミンA）
     - ビタミンB群（B1, B2, B3, B6, B12）
     - ビタミン（C, K, E）
     - ミネラル（ナトリウム、マグネシウム、カルシウム、リン、セレン、銅、マンガン）
     - 要注意項目（食物繊維）
   - 「×」ボタンまたは背景をクリックで閉じられる

**期待される動作：**
- 食品が追加されていない場合は、すべての値が0またはデフォルト値で表示される
- 食品を追加すると、値が更新される

---

### 2.2 炭水化物表示の改善

**確認手順：**
1. ホーム画面に移動
2. 栄養素ゲージを確認
3. **確認ポイント：**
   - 「正味炭水化物（不要）」というラベルが表示される
   - 全栄養素モーダルでも「正味炭水化物: X.X g (不要)」と表示される

**期待される動作：**
- 炭水化物が0gの場合は「optimal」状態（緑色）
- 炭水化物が0gより大きい場合は「warning」状態（黄色/オレンジ色）

---

## 3. 内臓肉データの確認

### 3.1 内臓肉の検索と追加

**確認手順：**
1. 入力画面で「レバー」または「牛レバー」と入力
2. **確認ポイント：**
   - 「牛レバー」が候補に表示される
   - 選択すると、栄養情報に「ビタミンB12: 59.3μg/100g」「銅: 14.6mg/100g」などが表示される
   - プレビューで確認すると、ビタミンB12や銅が大幅に増加する

**期待される動作：**
- 内臓肉（レバー、ハツ、腎臓、脾臓、脳、スエット）が検索できる
- 内臓肉は通常の肉よりも栄養素が高い（特にビタミンB12、銅、セレンなど）

---

## 4. エラー確認

### 4.1 エラーが発生しないことの確認

**確認手順：**
1. ブラウザのコンソールを開く（F12）
2. 各機能を操作
3. **確認ポイント：**
   - エラーメッセージが表示されない
   - 警告メッセージが表示されない（React Hooksの警告など）

**期待される動作：**
- すべての操作がエラーなく実行される
- パフォーマンスの問題がない（動作が遅くならない）

---

## 5. 動作確認チェックリスト

- [ ] 食品候補が2文字以上で表示される
- [ ] 日本語名（「豚バラ」など）で検索できる
- [ ] 食品を選択すると栄養情報が表示される
- [ ] 「栄養解説」ボタンが表示され、クリックでArgument Cardが開く
- [ ] 「プレビュー」ボタンが表示され、クリックでプレビューが表示される
- [ ] プレビューで現在の値と追加後の値が正しく表示される
- [ ] 食品を追加すると、アラートが表示されない
- [ ] ホーム画面で「全栄養素を見る」ボタンが表示される
- [ ] 全栄養素モーダルで全栄養素が表示される
- [ ] 炭水化物に「（不要）」と表示される
- [ ] 内臓肉（レバーなど）が検索できる
- [ ] エラーが発生しない

---

## トラブルシューティング

### 問題：食品候補が表示されない
- **原因：** 入力が2文字未満
- **解決策：** 2文字以上入力する

### 問題：「栄養解説」ボタンが表示されない
- **原因：** 食品を選択していない
- **解決策：** 食品候補から食品を選択する

### 問題：プレビューが表示されない
- **原因：** 食品を選択していない、またはdailyLogが存在しない
- **解決策：** 食品を選択し、プロファイル設定で性別を入力する

### 問題：栄養素が増えない
- **原因：** 食品データベースに該当する食品がない
- **解決策：** 食品名を正確に入力するか、候補から選択する

