# 修正した問題（2026-01-03）

## 修正済み

### 1. 履歴画面の「サマリー」ボタンの背景色を濃く
- 非アクティブ時の背景色を `transparent` から `var(--color-bg-secondary)` に変更
- テキスト色を `var(--color-text-primary)` に変更
- フォントウェイトを `600` に変更

### 2. 栄養素ゲージのモーダル背景色を黒に
- 背景色を `white` から `var(--color-bg-primary)` に変更（ダークモード対応）

### 3. カスタム食品登録画面の単位表示を修正
- `unit="g/100g"` → `unit="g"` に変更（100gが2回表示される問題を修正）
- 「100gあたりの値」という説明を追加

### 4. 履歴画面に抗栄養素の表示を追加
- フィチン酸、シュウ酸、レクチンのゲージを追加
- 抗栄養素セクションを追加（目標値は0mg）

### 5. 履歴画面の空データ時のメッセージを追加
- データがない場合に「ホーム画面から食品を追加してください」というメッセージを表示

### 6. カスタム食品登録画面の「← 戻る」ボタンを「←」に変更
- 「← 戻る」→「←」に変更

### 7. BioHackDashboardのNaN表示を修正
- `metrics.protein`や`metrics.fat`がundefinedの場合に`metrics.effectiveProtein`や`metrics.fatTotal`を使用
- NaNを防ぐためのチェックを追加

### 8. タンパク質計算式の数値不一致を修正
- 計算結果と実際の目標値が一致するように修正
- 不一致がある場合は警告を表示

## 未修正・要確認

### 1. 12月11日のデータが違反になっている理由
- バター、サーモン、牛リブアイだけなのに違反になっている
- 違反検出ロジック: `plantProteinTotal > 0 || fiberTotal > 0 || foods.some(food => food.type === 'plant')`
- バターに食物繊維が含まれている可能性があるが、foodsDatabaseでは`fiber: 0`になっている
- 要確認: 実際のデータで`fiberTotal`や`plantProteinTotal`が0より大きいかどうか

### 2. タンパク質表示が100gと110gで違う
- 計算式では110.0g/日なのに、表示は100.0gになっている
- `currentTarget`と実際の`target`が一致していない可能性がある
- 修正済み: 計算結果と実際の目標値が一致するように修正、不一致がある場合は警告を表示

### 3. カスタム食品登録画面の「0.0 / 100.0 g」表示
- これは`target={100}`で、`unit="g"`なので「0.0 / 100.0 g」と表示されている
- ユーザーは「100gは食品の量であって、栄養素の単位ではない」と言っている
- 修正済み: 「100gあたりの値」という説明を追加

### 4. ダークモードの設定
- ライトモードも追加（後でやることで）
- 現在はダークモードのみ実装

### 5. ShopScreenの実装
- 通知機能の表示場所: 設定画面の「通知設定」セクションに表示されている
- 他に追加機能: 現在はドット絵UIのみ

### 6. BioHackDashboardがいるか？
- 何を表しているのか: 代謝状態、タンパク質・脂質の達成率、ビタミン・ミネラルの状態を表示
- NaN表示を修正済み

### 7. 移行用の機能
- かなり難しそうだけどどうする？
- 抗栄養素セクションも移行期間によって変わる？
- 要検討

### 8. ストア審査チェックリスト
- Rulesで口調が命令的でも提案として受け取るというのはもうやってる？できてる？
- `.cursorrules`を確認する必要がある

---

最終更新: 2026-01-03

