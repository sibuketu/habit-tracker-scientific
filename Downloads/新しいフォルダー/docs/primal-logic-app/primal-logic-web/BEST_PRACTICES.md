# CarnivoreGuid ベストプラクティス

## 最終更新: 2025年1月

## コンテキストエンジニアリング（2025年版）

### 実装済み機能

1. **構造化プロンプト（XMLタグ使用）**
   - `<system_prompt>`, `<context>`, `<conversation_history>`, `<input_data>`, `<instruction>` タグで構造化
   - 情報の境界を明確化し、モデルの推論精度を最大化

2. **Chain of Thought (CoT) の言語分離**
   - `<thinking>` タグ内で英語で論理推論
   - `<answer>` タグ内で日本語で最終回答
   - 推論精度の向上を実現

3. **Chain of Verification (CoVe) による自己検証**
   - ベースライン作成 → 検証計画 → 検証実行 → 最終回答の4ステップ
   - ハルシネーション抑制

4. **既存知識の誤りを防ぐ（RAGと引用）**
   - `<citations>` タグで引用情報を構造化
   - 引用がない回答を検出し、警告を出力
   - ハルシネーション防止

## セキュリティベストプラクティス

### 実装済み対策

- ✅ 入力値のバリデーション
- ✅ XSS対策
- ✅ APIキーの環境変数管理
- ✅ 健康情報の適切な取り扱い
- ✅ エラーハンドリングの徹底

### 推奨事項

- コミット前に `@rules/security.mdc` を参照してセキュリティチェック
- テスト駆動開発（実装前にテストケースを作成）

## コーディング規約

### 実装済みルール

- ✅ 関数コンポーネント + Hooks
- ✅ TypeScript Strict mode
- ✅ 'any' 型の禁止
- ✅ エラーハンドリング必須
- ✅ 完成したコードのみコミット

### 推奨事項

- 変数名・関数名は英語、コメントは日本語OK
- コードは「完成して動く状態」で出す（TODOだけ残す形は避ける）

## Cursor × Obsidian 連携

### セットアップ済み

- ✅ `.cursor/rules/` フォルダにルールファイルを配置
  - `tech-stack.mdc`: 技術スタックとコーディング規約
  - `security.mdc`: セキュリティ監査ルール
  - `carnivore-logic.mdc`: Carnivoreダイエットのロジックと原則

### 推奨ワークフロー

1. Obsidianで仕様を書く → `second-brain/` フォルダに保存
2. Easy Bakeでコンパイル → `docs/full_spec.md` に統合
3. Cursor Composerで実装 → `@docs/full_spec.md` と `@rules/tech-stack.mdc` を参照
4. 実装・検証 → Cursorが自動でコード生成・修正
5. レビュー → セキュリティチェック（`@rules/security.mdc`）
6. Obsidian更新 → 仕様変更があれば `second-brain/` を更新

## パフォーマンス最適化

### 今後の改善予定

- [ ] コード分割とレイジーローディング
- [ ] 画像最適化
- [ ] キャッシュ戦略の改善
- [ ] React.memo の適切な使用
- [ ] useMemo, useCallback の最適化

## UI/UX改善

### 今後の改善予定

- [ ] モバイルファーストデザインの最適化
- [ ] アクセシビリティの向上（ARIA属性、キーボードナビゲーション）
- [ ] ダークモード対応
- [ ] ローディング状態の改善
- [ ] エラーメッセージの改善

## テスト戦略

### 推奨事項

- 実装前にテストケースを作成
- Jestを使用したユニットテスト
- テストが通ることを完了条件にする
- AIにテストを実行させ、通るまで修正させる

