# Cursor接続切れたときの対処法

## 接続が切れたときの基本的な対処

### 1. 自動再接続を待つ

Cursorは自動的に再接続を試みます。数秒待ってみてください。

### 2. 手動で再接続

- **Ctrl + R** (Windows) / **Cmd + R** (Mac): ページをリロード
- **F5**: ブラウザをリロード

### 3. ターミナルで確認

開発サーバーが動いているか確認：

```bash
# ターミナルで確認
npm run dev
```

エラーが出ている場合は、サーバーを再起動：

```bash
# Ctrl + C で停止
# その後、再起動
npm run dev
```

## TryAgain vs Resume の違い

### TryAgain（再試行）

**用途**: 一時的なエラー（ネットワークエラー、レート制限など）

**動作**:
- 同じリクエストを再度送信
- 会話履歴は保持される（`messages` stateに保存されている）
- ユーザーが手動で「再試行」ボタンをクリック

**メリット**:
- シンプルで確実
- カーニボアの質問は短い会話が多いため、これで十分

**実装例**:
```typescript
// エラー時に「再試行」ボタンを表示
<button onClick={() => handleSendMessage()}>
  再試行
</button>
```

### Resume（再開）

**用途**: 長時間の会話セッションを維持したい場合

**動作**:
- 会話履歴をサーバー側やローカルストレージに保存
- 接続が切れた後、保存された会話から再開
- より複雑な実装が必要

**メリット**:
- ユーザー体験が良い（会話が途切れない）
- 長時間の会話に適している

**デメリット**:
- 実装が複雑
- カーニボアの質問は短い会話が多いため、過剰な機能

## Primal Logicでの推奨

**TryAgain（再試行）を推奨**

理由:
1. カーニボアの質問は短い会話が多い
2. 会話履歴は既に`messages` stateで管理されている
3. エラー時は「再試行」ボタンを表示するだけで十分
4. シンプルで確実

## 実装例

現在の実装では、エラー時にメッセージを表示し、ユーザーが再度質問を入力することで「再試行」が可能です。

将来的に「再試行」ボタンを追加する場合は：

```typescript
// エラー時に「再試行」ボタンを表示
{error && (
  <button onClick={() => handleSendMessage()}>
    再試行
  </button>
)}
```

## トラブルシューティング

### 接続が頻繁に切れる場合

1. **ネットワーク環境を確認**: WiFiの接続状況を確認
2. **ファイアウォールを確認**: 開発サーバーのポート（5173）がブロックされていないか
3. **ブラウザのキャッシュをクリア**: ブラウザの設定からキャッシュをクリア

### API接続が切れる場合

1. **APIキーを確認**: `.env`ファイルのAPIキーが正しいか
2. **クレジットを確認**: OpenAI/Geminiアカウントにクレジットが残っているか
3. **レート制限**: リクエストが多すぎる場合は、しばらく待つ

