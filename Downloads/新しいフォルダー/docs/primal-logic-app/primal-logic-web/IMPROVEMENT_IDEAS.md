# Primal Logic - 改善アイデア・要望

## 1. 写真解析機能の改善

### 1.1 フォローアップクエスチョン機能
- **現状**: `analyzeFoodName`には`followupQuestions`があるが、`analyzeFoodImage`にはない
- **要望**: 写真解析後、g数や栄養素の調整をフォローアップクエスチョンで確認
- **実装方針**: 
  - `analyzeFoodImage`の戻り値に`followupQuestions`を追加
  - 解析結果表示後に、必要に応じてフォローアップ質問を表示
  - ユーザーが回答した内容を元に、栄養素や重量を再計算

### 1.2 スキャン中のTips表示
- **現状**: 食品名解析時にはTipsが表示されるが、写真解析時には表示されない
- **要望**: 写真解析中にもTipsを表示して待ち時間を有効活用
- **実装方針**:
  - `analyzeFoodImage`実行中にTipsを表示
  - `CustomFoodScreen`や`ButcherSelect`の写真解析処理にTips表示を追加

### 1.3 スキャン速度の改善
- **現状**: 写真解析に時間がかかる
- **要望**: 解析速度を向上させたい
- **実装方針**:
  - 画像のリサイズ（解像度を下げる）でAPI呼び出しを高速化
  - キャッシュ機能の追加（同じ画像の再解析を避ける）
  - プログレスバーの表示で体感速度を向上

## 2. バーコード読み取りのスマホ対応

### 2.1 問題点
- **現状**: スマホで「このブラウザは対応してません Chrome or Safari」と表示される
- **原因**: `isBarcodeDetectorAvailable()`が`'BarcodeDetector' in window`だけをチェックしているが、実際にはモバイルブラウザ（特にiOS Safari）では`BarcodeDetector` APIが利用できない
- **実装方針**:
  - モバイルブラウザの検出を追加
  - iOS Safariの場合は、代替手段（画像アップロード方式）を案内
  - Android Chromeの場合は、`BarcodeDetector` APIの実際の動作確認を追加
  - フォールバック: `@zxing/library`を使用した画像ベースのバーコード読み取り

## 3. フィードバック機能のご褒美システム

### 3.1 アイデア
- **要望**: バグ報告・機能提案へのご褒美（例：限定機能の先行開放）
- **実装案**:
  - フィードバック送信時に、ユーザーIDとフィードバック内容を記録
  - 有用なフィードバック（バグ報告、機能提案）を送ったユーザーに、限定機能の先行開放
  - 例：コミュニティ機能の先行開放、新しい分析機能の先行開放など
  - フィードバックの有用性を評価するシステム（AIによる評価、または手動評価）

### 3.2 実装する場合の機能候補
- コミュニティ機能の先行開放
- 新しい分析機能（詳細な統計、グラフなど）
- カスタムテーマ機能
- エクスポート機能の拡張（CSV、PDFなど）

## 4. AI機能説明の形式改善

### 4.1 要望
- **現状**: AIが機能を説明する際の形式が統一されていない
- **要望**: 
  - 機能ごとに記号ナンバリング（1⃣、2⃣、3⃣など）
  - 各機能内の手順は数字（1、2、3...）で番号付け
  - 例：
    ```
    1⃣ 食品追加方法
    1. ホーム画面の「+ 食品追加」をタップ
    2. 食品名を入力して「AI推測」をタップ
    3. 栄養素を確認・修正して「保存」をタップ
    ```

### 4.2 実装方針
- `chatWithAIStructured`のプロンプトに、機能説明の形式を追加
- 機能説明を生成する際のテンプレートを作成
- 記号ナンバリングと数字ナンバリングの使い分けを明確化

## 5. その他の改善要望

### 5.1 パフォーマンス改善
- 写真解析の速度向上
- バーコード読み取りの速度向上
- 画面遷移の速度向上

### 5.2 UX改善
- スキャン中のTips表示
- フォローアップクエスチョンの改善
- エラーメッセージの改善

